<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</title>
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f8f9fa;
      padding: 5px;
      color: #333;
    }
    select
    {
      max-width: 99%;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    .header {
      text-align: center;
      margin-bottom: 30px;
    }
    .header h1 {
      font-size: 22px;
      margin: 0;
      color: #2c3e50;
    }
    .selector {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      margin-bottom: 30px;
    }
    select, button {
      padding: 10px 16px;
      font-size: 16px;
      border: 1px solid #ced4da;
      border-radius: 8px;
      margin-right: 10px;
      margin-bottom: 10px;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    #materialCard {
      display: none;
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="header">
      <h1>üîç –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</h1>
    </div>
    <p style="padding: 5px;"><a href="index.html" style="color: inherit; text-decoration: none; display: block; height: 100%;">‚Ü©Ô∏è –≤ –º–µ–Ω—é</a></p>
    <div class="selector">
      <div style="margin-bottom:15px;">
        <label><strong>üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong></label><br>
        <select id="categorySelect" onchange="updateMaterialList()">
          <option value="">‚Äî –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é ‚Äî</option>
          <option value="steels">–°—Ç–∞–ª–∏ –∏ —Å–ø–ª–∞–≤—ã –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ</option>
          <option value="aluminum">–ê–ª—é–º–∏–Ω–∏–π –∏ –∞–ª—é–º–∏–Ω–∏–µ–≤—ã–µ —Å–ø–ª–∞–≤—ã</option>
          <option value="copper">–ú–µ–¥—å –∏ —Å–ø–ª–∞–≤—ã</option>
          <option value="titanium">–¢–∏—Ç–∞–Ω –∏ —Å–ø–ª–∞–≤—ã</option>
          <option value="cast_irons">–ß—É–≥—É–Ω—ã</option>
        </select>
      </div>
    
      <div>
        <label><strong>üîç –ú–∞—Ä–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∞:</strong></label><br>
        <select id="materialSelect">
          <option value="">‚Äî –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é ‚Äî</option>
        </select>
      </div>
    
      <button onclick="showMaterial()" style="margin-top:15px;">–ü–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É üìÑ</button>
    </div>
    
    <div id="materialCard"></div>
    <!-- <div class="selector">
      <select id="materialSelect">
        <option value="">‚Äî –í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª ‚Äî</option>
        <option value="–°—Ç3—Å–ø">–°—Ç3—Å–ø üìú –ì–û–°–¢ 380-2005</option>
        <option value="–ê–ö6">–ê–ö6 üìú –ì–û–°–¢ 4784-2019</option>
      </select>
      <button onclick="showMaterial()">–ü–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É üìÑ</button>
    </div> -->

    <div id="materialCard"></div>
  </div>

  <script>

// ‚úÖ –î–∞–Ω–Ω—ã–µ ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
let materialsByCategory = {};

function updateMaterialList() {
  const categorySelect = document.getElementById('categorySelect');
  const materialSelect = document.getElementById('materialSelect');
  const category = categorySelect.value;

  // –û—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–∞—Ä–æ–∫
  materialSelect.innerHTML = '<option value="">‚Äî –í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä–∫—É ‚Äî</option>';

  if (!category) return;

  const materials = materialsByCategory[category];
  if (!materials || materials.length === 0) {
    materialSelect.innerHTML = '<option value="">–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</option>';
    return;
  }

  materials.forEach(material => {
    const option = document.createElement('option');
    option.value = material.code;
    option.textContent = `${material.code} üìú ${material.standard}`;
    materialSelect.appendChild(option);
  });
}

function showMaterial() {
  const categorySelect = document.getElementById('categorySelect');
  const materialSelect = document.getElementById('materialSelect');
  const cardContainer = document.getElementById('materialCard');

  const category = categorySelect.value;
  const materialCode = materialSelect.value;

  if (!category || !materialCode) {
    cardContainer.style.display = 'none';
    return;
  }

  // ‚úÖ –ò—â–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  const materialsList = materialsByCategory[category];
  if (!materialsList) {
    cardContainer.innerHTML = "<div style='color:red;'>–ö–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</div>";
    cardContainer.style.display = 'block';
    return;
  }

  const material = materialsList.find(m => m.code === materialCode);
  if (!material) {
    cardContainer.innerHTML = "<div style='color:red;'>–ú–∞—Ç–µ—Ä–∏–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω</div>";
    cardContainer.style.display = 'block';
    return;
  }

  // üé® –¶–≤–µ—Ç–æ–≤–∞—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ ‚Äî —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å
  let colorBadge = material.color_marking
    ? `<span style="background:#dc3545; color:white; padding:4px 12px; border-radius:20px; font-weight:600;">${material.color_marking}</span>`
    : '';

  // üß™ –•–∏–º–∏—á–µ—Å–∫–∏–π —Å–æ—Å—Ç–∞–≤ ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
  let chemItems = [];
  for (let [element, value] of Object.entries(material.chemical_composition)) {
    chemItems.push(`${element}: ${value}`);
  }
  let chemString = chemItems.join(', ');

  // üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç–∞–ª–µ–π
  let calculatorsHtml = '';
  if (category === "steels") {
    // –ò–∑–≤–ª–µ–∫–∞–µ–º —á–∏—Å–ª–æ –∏–∑ —Å—Ç—Ä–æ–∫–∏ "245 –ú–ü–∞" –∏–ª–∏ "‚â•280 –ú–ü–∞"
    let sigma_t_str = material.mechanical_properties.yield_strength;
    let sigma_t = parseFloat(sigma_t_str.replace(/[^\d.-]/g, ''));
    calculatorsHtml = `
      <div style="margin-top:20px; background:#e7f3ff; padding:16px; border-radius:8px;">
        <h4>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã</h4>
        <div style="margin-bottom:16px;">
          <strong>–†–∞—Å—á—ë—Ç–Ω–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ</strong><br>
          Œ≥—Å: 
          <select id="gamma_c" style="padding:6px; margin:5px;">
            <option value="0.9">0.9</option>
            <option value="1.0" selected>1.0</option>
            <option value="1.1">1.1</option>
          </select>
          <button onclick="calculateStress(${sigma_t})" style="padding:6px 12px; background:#007bff; color:white; border:none; border-radius:4px; cursor:pointer;">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
          <div id="result_stress" style="margin-top:8px; font-weight:600; color:#28a745;">‚Äî</div>
        </div>
      </div>
      <script>
        function calculateStress(sigma_t) {
          const gamma_c = parseFloat(document.getElementById('gamma_c').value);
          const gamma_m = 1.025;
          const R = (sigma_t / gamma_m * gamma_c).toFixed(1);
          document.getElementById('result_stress').innerText = \`R = \${R} –ú–ü–∞\`;
        }
        calculateStress(${sigma_t});
      <\/script>
    `;
  }

  // üñºÔ∏è –ö–∞—Ä—Ç–æ—á–∫–∞
  cardContainer.innerHTML = `
    <div class="card" style="background:white; padding:24px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.05); margin-top:20px;">
      <div style="border-bottom:2px solid ${category === 'steels' ? '#007bff' : category === 'aluminum' ? '#17a2b8' : '#6c757d'}; padding-bottom:12px; margin-bottom:24px;">
        <h2 style="margin:0; color:#212529;">${material.code} üìú ${material.standard}</h2>
        ${colorBadge}
      </div>
      <div style="margin-bottom:20px;"><strong>–¢–∏–ø:</strong> ${material.type}</div>
      <div style="margin-bottom:20px;"><strong>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:</strong> ${material.temp_range}</div>
      <div style="margin-bottom:20px;"><strong>–ê–Ω–∞–ª–æ–≥:</strong> ${material.analog}</div>
      <div><strong>üî¨ –•–∏–º. —Å–æ—Å—Ç–∞–≤:</strong> ${chemString}</div>
      <div style="margin-top:10px;"><strong>‚öôÔ∏è –ú–µ—Ö. —Å–≤–æ–π—Å—Ç–≤–∞:</strong> 
        ${Object.entries(material.mechanical_properties)
          .map(([key, val]) => `${key}: ${val}`)
          .join(', ')}
      </div>
      <div style="margin-top:10px; background:#fff3cd; padding:16px; border-left:4px solid #ffc107; border-radius:4px;">
        ${material.description}
      </div>
      ${calculatorsHtml}
    </div>
  `;
  cardContainer.style.display = 'block';
}


  </script>
<script src="script.js"></script>

<script>
  // –¢–µ–ø–µ—Ä—å loadKnowledgeData –¥–æ—Å—Ç—É–ø–Ω–∞
  loadKnowledgeData('materials.js').then(data => {
    materialsByCategory = data;
    updateMaterialList();
  });
</script>

</body>
</html>

