<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ß–µ–∫-–ª–∏—Å—Ç</title>
    <style>
        :root {
            --color-primary: #2c3e50;
            --color-success: #27ae60;
            --color-danger: #c0392b;
            --color-warning: #f39c12;
            --color-info: #3498db;
            --color-light: #ecf0f1;
            --color-dark: #34495e;
            --color-gray: #95a5a6;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--color-dark);
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            background: var(--color-primary);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 10px 10px 0 0;
        }

        h1, h2, h3 {
            margin-bottom: 0.5em;
        }

        .card {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 0 0 10px 10px;
            box-shadow: var(--shadow);
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: var(--color-dark);
        }

        select, input, button, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
        }

        select:focus, input:focus, textarea:focus {
            outline: none;
            border-color: var(--color-info);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        button {
            background: var(--color-primary);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        button:hover {
            background: var(--color-dark);
            transform: translateY(-2px);
        }

        #checklist-container {
            display: none;
        }

        .checklist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--color-light);
        }

        .meta-data {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .meta-data input {
            width: auto;
            min-width: 150px;
        }

        .parameter-group {
            margin-bottom: 25px;
            border: 1px solid #eee;
            border-radius: 8px;
            overflow: hidden;
        }

        /* .group-header {
            background: var(--color-light);
            padding: 15px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        } */
        .group-header {
    background: var(--color-light);
    padding: 15px;
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
}

.group-header:hover {
    background: #dde4e6;
}

.group-content {
    padding: 0 15px;
    display: block; /* –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ */
    transition: all 0.3s ease;
}

.parameter-group {
    margin-bottom: 25px;
    border: 1px solid #eee;
    border-radius: 8px;
    overflow: hidden;
}

        .group-content {
            padding: 0 15px;
        }

        .parameter-card {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .parameter-card:last-child {
            border-bottom: none;
        }

        .parameter-info {
            flex: 1;
        }

        .parameter-controls {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
            min-width: 200px;
        }

        .param-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--color-dark);
        }

        .param-norm, .param-method {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .param-method {
            font-style: italic;
            color: #7f8c8d;
        }

        /* === –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ü—Ä–∏–Ω—è—Ç—å/–û—Ç–∫–ª–æ–Ω–∏—Ç—å === */
.status-checkbox {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    width: 80px;
    height: 30px;
    padding: 0;
    margin: 10px;
    border: 2px solid #cccccc00;
    border-radius: 8px;
    background-color: #f5f5f500;
    transition: all 0.3s ease;
    text-align: center;
}

.status-checkbox input[type="checkbox"] {
    display: none; /* –°–∫—Ä—ã–≤–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–π —á–µ–∫–±–æ–∫—Å */
}

.status-checkbox .status-label {
    font-size: 12px;
    font-weight: bold;
    color: #666;
    margin-top: 4px;
    line-height: 1.2;
    padding: 0;
    text-align: center;
    width: 100%;
    transition: all 0.3s ease;
}

/* –ê–∫—Ç–∏–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ "–ü—Ä–∏–Ω—è—Ç—å" */
.status-checkbox.accept-btn input[type="checkbox"]:checked + .status-label {
    background-color: #27ae60 !important;
    color: white !important;
    border-color: #27ae60 !important;
}

/* –ê–∫—Ç–∏–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å" */
.status-checkbox.reject-btn input[type="checkbox"]:checked + .status-label {
    background-color: #c0392b !important;
    color: white !important;
    border-color: #c0392b !important;
}

/* –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –¥—Ä—É–≥–æ–π */
.status-checkbox.accept-btn:not(:has(input:checked)) {
    background-color: #e0e0e000 !important;
    border-color: #cccccc00 !important;
}

.status-checkbox.reject-btn:not(:has(input:checked)) {
    background-color: #e0e0e000 !important;
    border-color: #cccccc00 !important;
}

/* –î–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏ (–µ—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç :has) ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º JS –Ω–∏–∂–µ */
        /* .status-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .status-label {
            font-size: 14px;
            color: var(--color-gray);
            border: 1px solid var(--color-gray);
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .status-checkbox input[type="checkbox"]:checked + .status-label {
            color: var(--color-success);
            border-color: var(--color-success);
            font-weight: bold;
        } */

        /* .photo-btn {
            background: var(--color-info);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s ease;
        }

        .photo-btn:hover {
            background: #2980b9;
        } */
        .photo-btn {
    background: var(--color-info);
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.3s ease;
    
    /* üî• –ù–û–í–´–ï –ü–ê–†–ê–ú–ï–¢–†–´ */
    width: 200px;           /* ‚Üê –®–∏—Ä–∏–Ω–∞ 200px */
    height: 44px;           /* ‚Üê –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ ‚Äî –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ */
    padding: 0;             /* ‚Üê –£–±–∏—Ä–∞–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã ‚Äî —Ç–µ–ø–µ—Ä—å —Ä–∞–∑–º–µ—Ä—ã –∑–∞–¥–∞—é—Ç—Å—è —è–≤–Ω–æ */
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 8px;        /* ‚Üê –î–æ–±–∞–≤–∏–º –Ω–µ–±–æ–ª—å—à–æ–π –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è */
}

/* üí° –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
.photo-btn:hover {
    background: #2980b9;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
}

        .photo-preview {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .photo-preview img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        .actions-footer {
            display: flex;
            justify-content: flex-end;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid var(--color-light);
        }

        .btn-complete {
            background: var(--color-success);
            max-width: 200px;
        }

        .completed-checklists {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .completed-item {
            background: white;
            padding: 10px 15px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .completed-item:hover {
            transform: translateY(-2px);
        }

        .completed-icon {
            color: var(--color-success);
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .parameter-card {
                flex-direction: column;
            }
            
            .parameter-controls {
                width: 100%;
                align-items: flex-start;
            }
            
            .meta-data {
                flex-direction: column;
            }
            
            .meta-data input {
                width: 100%;
            }

            .compact-controls {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-bottom: 10px;

}

.value-inputs {
    display: flex;
    flex-direction: row; /* ‚Üê –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ */
    gap: 8px;           /* ‚Üê –û—Ç—Å—Ç—É–ø –º–µ–∂–¥—É –ø–æ–ª—è–º–∏ */
    align-items: center; /* ‚Üê –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
}

.value-inputs input {
    width: 70px;        /* ‚Üê –£–¥–æ–±–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –¥–ª—è —á–∏—Å–µ–ª */
    padding: 6px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 12px;
    text-align: center;
    height: 30px;       /* ‚Üê –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è */
}
/* –¶–≤–µ—Ç–∞ –¥–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤ ‚Äî –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ */
.status-checkbox input[type="checkbox"]:checked + .status-label {
    font-weight: bold;
}

.status-checkbox input[type="checkbox"][data-status="accept"]:checked + .status-label {
    background-color: #d4edda !important;
    color: #155724 !important;
    border-color: #27ae60 !important;
}

.status-checkbox input[type="checkbox"][data-status="reject"]:checked + .status-label {
    background-color: #f8d7da !important;
    color: #721c24 !important;
    border-color: #c0392b !important;
}
/* .status-checkboxes {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.status-checkbox {
    display: flex;
    align-items: center;
    gap: 5px;
    cursor: pointer;
    font-size: 12px;
}

.status-checkbox input[type="checkbox"] {
    width: 16px;
    height: 16px;
    margin: 0;
} */

.status-label {
    font-size: 12px;
    padding: 3px 6px;
    border-radius: 3px;
    border: 1px solid var(--color-gray);
    min-width: 60px;
    text-align: center;
}

.status-checkbox input[type="checkbox"]:checked + .status-label[data-status="accept"] {
    background: var(--color-success);
    color: white;
    border-color: var(--color-success);
}

.status-checkbox input[type="checkbox"]:checked + .status-label[data-status="reject"] {
    background: var(--color-danger);
    color: white;
    border-color: var(--color-danger);
}


        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>–ß–µ–∫-–ª–∏—Å—Ç</h1>
            <!-- <p>–ù–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ | –¢—É—Ä–±–æ–∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä—ã</p> -->
        </header>
        <li><a href="index.html" style="color: inherit; text-decoration: none; display: block; height: 100%;">‚Ü©Ô∏è –≤ –º–µ–Ω—é</a></li>

        <div class="card" id="selection-container">
            <h2>–í—ã–±–æ—Ä –∏–∑–¥–µ–ª–∏—è –∏ –Ω–æ—Ä–º–∞—Ç–∏–≤–∫–∏</h2>
            <div class="form-group">
                <label for="product-type">–¢–∏–ø –∏–∑–¥–µ–ª–∏—è</label>
                <select id="product-type">
                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–¥–µ–ª–∏–µ --</option>
                    <option value="pipe">–¢—Ä—É–±–∞</option>
                    <option value="flange">–§–ª–∞–Ω–µ—Ü</option>
                    <option value="thrust_bearing">–ü–æ–¥—à–∏–ø–Ω–∏–∫ —É–ø–æ—Ä–Ω—ã–π</option>
                    <option value="sealing_ring">–ö–æ–ª—å—Ü–æ —É–ø–ª–æ—Ç–Ω–∏—Ç–µ–ª—å–Ω–æ–µ</option>
                    <!-- <option value="clamp_block">–ö–æ–ª–æ–¥–∫–∞</option> -->
                    <!-- <option value="bearing">–ü–æ–¥—à–∏–ø–Ω–∏–∫–∏ –∫–∞—á–µ–Ω–∏—è</option> -->
                    <!-- <option value="nozzle">–§–æ—Ä—Å—É–Ω–∫–∞</option> -->
                    <!-- <option value="labyrinth_seal">–£–ø–ª–æ—Ç–Ω–µ–Ω–∏–µ –ª–∞–±–∏—Ä–∏–Ω—Ç–Ω–æ–µ</option> -->
                 
                </select>
            </div>
            <div class="form-group">
                <label for="standard-type">–ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç</label>
                <select id="standard-type">
                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ—Ä–º–∞—Ç–∏–≤–∫—É --</option>
                    <!-- Options will be populated dynamically -->
                </select>
            </div>
            <div class="form-group">
                <label for="control-type">–í–∏–¥ –∫–æ–Ω—Ç—Ä–æ–ª—è</label>
                <select id="control-type">
                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥ –∫–æ–Ω—Ç—Ä–æ–ª—è --</option>
                    <option value="–í–ò–ö">–í–ò–ö</option>
                    <option value="–í—Ö–æ–¥–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å">–í—Ö–æ–¥–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å</option>
                    <option value="–ü—Ä–∏–µ–º–∫–∞">–ü—Ä–∏–µ–º–∫–∞</option>
                    <option value="–ì–∏–¥—Ä–æ–∏—Å–ø—ã—Ç–∞–Ω–∏—è">–ì–∏–¥—Ä–æ–∏—Å–ø—ã—Ç–∞–Ω–∏—è</option>
                    <option value="–£–ª—å—Ç—Ä–∞–∑–≤—É–∫">–£–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å</option>
                    
                </select>
            </div>
            <button id="generate-btn">–°–æ–∑–¥–∞—Ç—å —á–µ–∫-–ª–∏—Å—Ç</button>
        </div>

        <div id="checklist-container">
            <!-- Checklist content will be generated here -->
        </div>

        <div id="completed-checklists" class="completed-checklists">
            <!-- Completed checklists will appear here -->
        </div>

        <div style="text-align: center; margin: 40px 0 60px 0;">
            <button id="generate-report-btn" style="
                background: #00b618;
                color: white;
                border: none;
                padding: 14px 30px;
                border-radius: 8px;
                font-size: 18px;
                font-weight: bold;
                cursor: pointer;
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            ">
                –û–¢–ß–ï–¢
            </button>
        </div>
        <div id="report-output" style="
    margin-top: 30px;
    max-width: 1000px;
    margin-left: auto;
    margin-right: auto;
    padding: 20px;
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    font-family: 'Segoe UI', sans-serif;
    line-height: 1.6;
    white-space: pre-wrap;
    word-wrap: break-word;
"></div>
    </div>

    <script>
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const productTypeSelect = document.getElementById('product-type');
        const standardTypeSelect = document.getElementById('standard-type');
        const controlTypeSelect = document.getElementById('control-type');
        const generateBtn = document.getElementById('generate-btn');
        const selectionContainer = document.getElementById('selection-container');
        const checklistContainer = document.getElementById('checklist-container');
        const completedChecklistsContainer = document.getElementById('completed-checklists');

        // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —á–µ–∫-–ª–∏—Å—Ç–æ–≤
        let completedChecklists = [];

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∏–∑–¥–µ–ª–∏—è
        productTypeSelect.addEventListener('change', updateStandardOptions);

        function updateStandardOptions() {
            const productType = productTypeSelect.value;
            standardTypeSelect.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ—Ä–º–∞—Ç–∏–≤–∫—É --</option>';
            
            if (productType && parametersDatabase[productType]) {
                const standards = parametersDatabase[productType].standards;
                for (const [key, standard] of Object.entries(standards)) {
                    const option = document.createElement('option');
                    option.value = key;
                    option.textContent = `${standard.name} - ${standard.description}`;
                    standardTypeSelect.appendChild(option);
                }
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ–∫-–ª–∏—Å—Ç–∞
        generateBtn.addEventListener('click', () => {
            const productType = productTypeSelect.value;
            const standardKey = standardTypeSelect.value;
            const controlType = controlTypeSelect.value;

            if (!productType || !standardKey || !controlType) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ–∫-–ª–∏—Å—Ç–∞.');
                return;
            }

            try {
                const standard = parametersDatabase[productType].standards[standardKey];
                renderChecklist(standard, productType, controlType);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á–µ–∫-–ª–∏—Å—Ç
                selectionContainer.style.display = 'none';
                checklistContainer.style.display = 'block';
                
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ–∫-–ª–∏—Å—Ç–∞. –í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é.');
                console.error(error);
            }
        });

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —á–µ–∫-–ª–∏—Å—Ç–∞

        function renderChecklist(standardData, productType, controlType) {
    const checklistId = 'checklist-' + Date.now();
    
    const checklistHTML = `
        <div class="card" id="${checklistId}">
            <div class="checklist-header">
                <h2>${productTypeSelect.options[productTypeSelect.selectedIndex].text}, 
                    ${standardData.name}, 
                    ${controlTypeSelect.options[controlTypeSelect.selectedIndex].text}
                </h2>
            </div>

            <div id="parameters-container-${checklistId}">
                ${renderParameters(standardData, controlType)}
            </div>
            <div class="checklist-header">
                <div class="meta-data">
                    <input type="text" placeholder="‚Ññ —á–µ—Ä—Ç–µ–∂–∞" class="drawing-number"> <!-- –ù–û–í–û–ï –ü–û–õ–ï -->
                    <input type="text" placeholder="‚Ññ –ø–∞—Ä—Ç–∏–∏/–∑–∞–∫–∞–∑–∞" class="batch-number">
                    <input type="date" class="inspection-date">
                    <input type="text" placeholder="–§–ò–û –ò–Ω—Å–ø–µ–∫—Ç–æ—Ä–∞" class="inspector-name">
                </div>
            </div>
            <div class="actions-footer">
                <button class="btn-complete" onclick="completeChecklist('${checklistId}')">–ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É</button>
            </div>
        </div>
    `;
    
    checklistContainer.innerHTML = checklistHTML;
    
    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
    const dateInput = checklistContainer.querySelector('.inspection-date');
    if (dateInput) {
        dateInput.valueAsDate = new Date();
    }

    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è/—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è –≥—Ä—É–ø–ø
    setTimeout(() => {
        const groupHeaders = document.querySelectorAll(`#${checklistId} .group-header`);
        groupHeaders.forEach(header => {
            header.addEventListener('click', function() {
                const content = this.nextElementSibling;
                if (content.style.display === 'none') {
                    content.style.display = 'block';
                } else {
                    content.style.display = 'none';
                }
            });
        });
    }, 100);
}

function renderParameters(standardData, controlType) {
    let html = '';
    
    standardData.parameters.forEach(group => {
        let groupParametersHTML = '';
        let hasVisibleParameters = false;
        
        group.parameters.forEach(param => {
            if (param.inspectionTypes && param.inspectionTypes.includes(controlType)) {
                hasVisibleParameters = true;
                groupParametersHTML += `
                    <div class="parameter-card">
                        <div class="parameter-info">
                            <div class="param-title">${param.name}</div>
                            <div class="param-norm">–ù–æ—Ä–º–∞—Ç–∏–≤: ${param.norm}</div>
                            <div class="param-method">–ú–µ—Ç–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª—è: ${param.method}</div>
                        </div>

                        <div class="parameter-controls">
                            <div class="compact-controls">
                                <div class="value-inputs">
                                    <input type="text" placeholder="–§–∞–∫—Ç" class="actual-value" maxlength="10">
                                    <input type="text" placeholder="–û—Ç–∫–ª." class="deviation-value" maxlength="10">
                                </div>
                                <div class="status-checkboxes">
                                    <label class="status-checkbox accept-btn">
                                        <input type="checkbox" class="param-status" name="status-${param.id}" data-status="accept" data-param="${param.id}">
                                        <span class="status-label">–ü—Ä–∏–Ω—è—Ç—å</span>
                                    </label>
                                    <label class="status-checkbox reject-btn">
                                        <input type="checkbox" class="param-status" name="status-${param.id}" data-status="reject" data-param="${param.id}">
                                        <span class="status-label">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</span>
                                    </label>
                                </div>
                            </div>
                            <button class="photo-btn" onclick="addPhoto('${param.id}')">–§–æ—Ç–æ</button>
                            <div class="photo-preview" id="photo-preview-${param.id}"></div>
                        </div>
                    </div>
                `;
            }
        });
        
        if (hasVisibleParameters) {
            html += `
                <div class="parameter-group">
                    <div class="group-header">
                        ${group.group}
                        <span>‚Üï</span>
                    </div>
                    <div class="group-content">
                        ${groupParametersHTML}
                    </div>
                </div>
            `;
        }
    });
    
    return html;
}



        function addPhoto(paramId) {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'image/*';
    input.style.display = 'none';

    input.onchange = function(e) {
        const file = e.target.files[0];
        if (!file) return;

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        if (!file.type.startsWith('image/')) {
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.');
            return;
        }

        // –°–æ–∑–¥–∞—ë–º URL –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
        const imageUrl = URL.createObjectURL(file);

        // –ù–∞—Ö–æ–¥–∏–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–µ–≤—å—é –∏ –∫–Ω–æ–ø–∫—É
        const previewContainer = document.getElementById(`photo-preview-${paramId}`);
        const photoBtn = document.querySelector(`button[onclick="addPhoto('${paramId}')"]`);

        // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Ñ–æ—Ç–æ
        previewContainer.innerHTML = '';

        // –î–æ–±–∞–≤–ª—è–µ–º –º–∏–Ω–∏–∞—Ç—é—Ä—É
        const img = document.createElement('img');
        img.src = imageUrl;
        img.style.width = '60px';
        img.style.height = '60px';
        img.style.objectFit = 'cover';
        img.style.borderRadius = '4px';
        img.style.border = '1px solid #ddd';
        previewContainer.appendChild(img);

        // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç –∫–Ω–æ–ø–∫–∏ –Ω–∞ –∑–µ–ª—ë–Ω—ã–π
        photoBtn.style.backgroundColor = '#27ae60';
        photoBtn.style.color = 'white';
        photoBtn.textContent = '–§–æ—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ';

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É –≤ data-–∞—Ç—Ä–∏–±—É—Ç –∫–Ω–æ–ø–∫–∏ –¥–ª—è –æ—Ç—á—ë—Ç–∞
        photoBtn.dataset.photoUrl = imageUrl;

        // –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω–∏–º –∏–º—è —Ñ–∞–π–ª–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        photoBtn.dataset.photoName = file.name;
    };

    document.body.appendChild(input);
    input.click();
}



function completeChecklist(checklistId) {
    const checklistElement = document.getElementById(checklistId);
    if (!checklistElement) return;

    // –°–æ–±–∏—Ä–∞–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
    const titleText = checklistElement.querySelector('h2').textContent.trim();
    const [product, , controlType] = titleText.split(',').map(s => s.trim());
    const drawingNumber = checklistElement.querySelector('.drawing-number')?.value.trim() || '';
    const batchNumber = checklistElement.querySelector('.batch-number')?.value.trim() || '';
    const inspectorName = checklistElement.querySelector('.inspector-name')?.value.trim() || '';

    // –°–æ–±–∏—Ä–∞–µ–º –í–°–ï –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî —Å —Ñ–æ—Ç–æ!
    const parameters = [];
    checklistElement.querySelectorAll('.parameter-card').forEach(card => {
        const paramTitle = card.querySelector('.param-title')?.textContent.trim() || '';
        const actualValue = card.querySelector('.actual-value')?.value.trim() || '';
        const deviationValue = card.querySelector('.deviation-value')?.value.trim() || '';

        let status = '–ù–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω';
        if (card.querySelector('input[data-status="accept"]:checked')) status = '–ü—Ä–∏–Ω—è—Ç';
        if (card.querySelector('input[data-status="reject"]:checked')) status = '–û—Ç–∫–ª–æ–Ω—ë–Ω';

        // –ü–æ–ª—É—á–∞–µ–º —Ñ–æ—Ç–æ, –µ—Å–ª–∏ –µ—Å—Ç—å
        const photoBtn = card.querySelector('button.photo-btn');
        const photoUrl = photoBtn.dataset.photoUrl || null;
        const photoName = photoBtn.dataset.photoName || null;

        parameters.push({
            title: paramTitle,
            actual: actualValue,
            deviation: deviationValue,
            status: status,
            photoUrl: photoUrl,   // ‚¨ÖÔ∏è –°–û–•–†–ê–ù–Ø–ï–ú –°–°–´–õ–ö–£ –ù–ê –§–û–¢–û
            photoName: photoName // ‚¨ÖÔ∏è –°–û–•–†–ê–ù–Ø–ï–ú –ò–ú–Ø –§–ê–ô–õ–ê (–¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
        });
    });

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç
    completedChecklists.push({
        id: checklistId,
        product,
        controlType,
        drawingNumber,
        batchNumber,
        inspectorName,
        completedAt: new Date().toLocaleString(),
        parameters: parameters
    });

    // –°–æ–∑–¥–∞—ë–º –º–∏–Ω–∏-—ç–ª–µ–º–µ–Ω—Ç
    const completedItem = document.createElement('div');
    completedItem.className = 'completed-item';
    completedItem.innerHTML = `
        <span class="completed-icon">‚úì</span>
        <span>${product} ‚Äî ${controlType}</span>
    `;
    completedItem.onclick = () => showChecklistDetails(checklistId);

    completedChecklistsContainer.appendChild(completedItem);

    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
    resetForm();
}

document.getElementById('generate-report-btn').addEventListener('click', function() {
    if (completedChecklists.length === 0) {
        document.getElementById('report-output').innerHTML = '<p style="color: #666; text-align: center;">–ù–µ—Ç –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö —á–µ–∫-–ª–∏—Å—Ç–æ–≤.</p>';
        return;
    }

    let report = '';

    completedChecklists.forEach(checklist => {
        // –ó–∞–≥–æ–ª–æ–≤–æ–∫
        report += `üìã ${checklist.product} ‚Äî ${checklist.controlType}\n`;
        report += `   ‚Ññ —á–µ—Ä—Ç–µ–∂–∞: ${checklist.drawingNumber || '‚Äî'} | ‚Ññ –ø–∞—Ä—Ç–∏–∏: ${checklist.batchNumber || '‚Äî'}\n`;
        report += `   –ò–Ω—Å–ø–µ–∫—Ç–æ—Ä: ${checklist.inspectorName || '‚Äî'} | ${checklist.completedAt}\n\n`;

        // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
        checklist.parameters.forEach(param => {
            let line = `‚Ä¢ ${param.title}`;

            if (param.actual) line += ` ‚Äî ${param.actual.replace('.', ',')} –º–º`;
            else line += ` ‚Äî –Ω–µ —É–∫–∞–∑–∞–Ω–æ`;

            if (param.deviation) line += ` (–æ—Ç–∫–ª.: ${param.deviation.replace('.', ',')} –º–º)`;

            line += ` ‚Äî `;

            // –¶–≤–µ—Ç–Ω–æ–π —Å—Ç–∞—Ç—É—Å
            let statusText = param.status;
            if (param.status === '–ü—Ä–∏–Ω—è—Ç') statusText = `<span style="background: #d4edda; color: #155724; padding: 2px 6px; border-radius: 4px; font-size: 13px;">${param.status}</span>`;
            else if (param.status === '–û—Ç–∫–ª–æ–Ω—ë–Ω') statusText = `<span style="background: #f8d7da; color: #721c24; padding: 2px 6px; border-radius: 4px; font-size: 13px;">${param.status}</span>`;
            else statusText = `<span style="background: #e9ecef; color: #495057; padding: 2px 6px; border-radius: 4px; font-size: 13px;">${param.status}</span>`;

            line += statusText;

            // –î–æ–±–∞–≤–ª—è–µ–º –º–∏–Ω–∏–∞—Ç—é—Ä—É —Ñ–æ—Ç–æ, –µ—Å–ª–∏ –µ—Å—Ç—å
            if (param.photoUrl) {
                line += ` <img src="${param.photoUrl}" style="width: 40px; height: 40px; object-fit: cover; border: 1px solid #ccc; border-radius: 4px; vertical-align: middle; margin-left: 8px;" />`;
            }

            report += line + '\n';
        });

        report += '\n_________\n\n';
    });

    report = report.replace(/\n_________\n\n$/, '');

    document.getElementById('report-output').innerHTML = report.replace(/\n/g, '<br>');
});


       
        function showChecklistDetails(checklistData) {
            alert(`–î–µ—Ç–∞–ª–∏ —á–µ–∫-–ª–∏—Å—Ç–∞:\n${checklistData.title}\n–ü–∞—Ä—Ç–∏—è: ${checklistData.batchNumber}\n–ò–Ω—Å–ø–µ–∫—Ç–æ—Ä: ${checklistData.inspectorName}\n–î–∞—Ç–∞: ${checklistData.completedAt}`);
        }

        // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã –∏ –ø–æ–∫–∞–∑ —Ñ–æ—Ä–º—ã –≤—ã–±–æ—Ä–∞
        function resetForm() {
            checklistContainer.innerHTML = '';
            checklistContainer.style.display = 'none';
            selectionContainer.style.display = 'block';
            
            // –°–±—Ä–æ—Å –∑–Ω–∞—á–µ–Ω–∏–π —Ñ–æ—Ä–º—ã
            productTypeSelect.value = '';
            standardTypeSelect.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ—Ä–º–∞—Ç–∏–≤–∫—É --</option>';
            controlTypeSelect.value = '';
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤ (–±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ —Ä–µ–Ω–¥–µ—Ä–∞)
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤ (–±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ —Ä–µ–Ω–¥–µ—Ä–∞)
        document.addEventListener('change', function(e) {
    const checkbox = e.target;
    if (!checkbox.classList.contains('param-status')) return;

    const paramName = checkbox.name;
    const isAccept = checkbox.dataset.status === 'accept';
    const isReject = checkbox.dataset.status === 'reject';

    // –°–Ω–∏–º–∞–µ–º –≥–∞–ª–æ—á–∫—É —É –¥—Ä—É–≥–æ–≥–æ —á–µ–∫–±–æ–∫—Å–∞ –≤ —ç—Ç–æ–π –≥—Ä—É–ø–ø–µ
    if (checkbox.checked) {
        document.querySelectorAll(`input[name="${paramName}"]`).forEach(cb => {
            if (cb !== checkbox) cb.checked = false;
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–æ–∫
        const label = checkbox.parentElement.querySelector('.status-label');
        label.textContent = isAccept ? '–ü—Ä–∏–Ω—è—Ç' : '–û—Ç–∫–ª–æ–Ω—ë–Ω';
    } else {
        // –ï—Å–ª–∏ —Å–Ω—è–ª–∏ ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
        const label = checkbox.parentElement.querySelector('.status-label');
        label.textContent = isAccept ? '–ü—Ä–∏–Ω—è—Ç—å' : '–û—Ç–∫–ª–æ–Ω–∏—Ç—å';
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –≤ —ç—Ç–æ–π –≥—Ä—É–ø–ø–µ
    const group = checkbox.closest('.parameter-card');
    const acceptBtn = group.querySelector('.accept-btn');
    const rejectBtn = group.querySelector('.reject-btn');

    // –ï—Å–ª–∏ –ø—Ä–∏–Ω—è—Ç ‚Äî –æ—Ç–∫–ª–æ–Ω–∏—Ç—å —Å–µ—Ä—ã–π, –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç
    if (acceptBtn.querySelector('input:checked')) {
        rejectBtn.style.backgroundColor = '#e0e0e0';
        rejectBtn.style.borderColor = '#ccc';
        rejectBtn.querySelector('.status-label').style.color = '#666';
    } else {
        rejectBtn.style.backgroundColor = '#f5f5f5';
        rejectBtn.style.borderColor = '#ccc';
        rejectBtn.querySelector('.status-label').style.color = '#666';
    }

    if (rejectBtn.querySelector('input:checked')) {
        acceptBtn.style.backgroundColor = '#e0e0e0';
        acceptBtn.style.borderColor = '#ccc';
        acceptBtn.querySelector('.status-label').style.color = '#666';
    } else {
        acceptBtn.style.backgroundColor = '#f5f5f5';
        acceptBtn.style.borderColor = '#ccc';
        acceptBtn.querySelector('.status-label').style.color = '#666';
    }
});

  // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
  window.addEventListener('DOMContentLoaded', async () => {
    parametersDatabase = await loadKnowledgeData('gosts.json');

    // –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å parametersDatabase
    // –ù–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–µ–∫-–ª–∏—Å—Ç
    initChecklistApp(); // <-- —Ç–≤–æ—è —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —á–µ–∫-–ª–∏—Å—Ç–∞
  });
    // –ü—Ä–∏–º–µ—Ä: –µ—Å–ª–∏ —É —Ç–µ–±—è –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è renderChecklist() ‚Äî –≤—ã–∑—ã–≤–∞–π –µ—ë –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
    function initChecklistApp() {
    // –ó–¥–µ—Å—å —Ç—ã –º–æ–∂–µ—à—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ—Å—å —Å–≤–æ–π –∫–æ–¥:
    // updateStandardOptions(), generateBtn.addEventListener(...) –∏ —Ç.–¥.
    console.log('‚úÖ parametersDatabase –∑–∞–≥—Ä—É–∂–µ–Ω:', parametersDatabase);
  }


    </script>
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
      <script src="script.js"></script>
</body>
</html>